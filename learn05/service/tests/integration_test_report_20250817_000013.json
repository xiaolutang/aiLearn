{
  "report_metadata": {
    "generated_at": "2025-08-17T00:00:13.180374",
    "test_environment": "集成测试环境",
    "test_suite_version": "1.0.0",
    "total_execution_time": 57.2449152469635
  },
  "execution_summary": {
    "start_time": "2025-08-16T23:59:15.934445",
    "end_time": "2025-08-17T00:00:13.179372",
    "total_duration": 57.2449152469635,
    "tests_executed": 7,
    "tests_passed": 6,
    "tests_failed": 1,
    "tests_skipped": 0
  },
  "test_statistics": {
    "total_tests": 7,
    "passed_tests": 6,
    "failed_tests": 1,
    "error_tests": 0,
    "timeout_tests": 0,
    "skipped_tests": 0
  },
  "key_metrics": {
    "success_rate": 85.71428571428571,
    "total_issues_found": 1,
    "high_priority_tests_passed": 4,
    "high_priority_tests_total": 5,
    "average_test_duration": 6.176388161523001
  },
  "quality_assessment": {
    "overall_quality_level": "一般",
    "success_rate": 85.71428571428571,
    "critical_issues_count": 0,
    "readiness_for_production": false
  },
  "test_results_by_priority": {
    "high": [
      {
        "test_name": "认证流程测试",
        "script": "test_authentication.py",
        "description": "测试用户认证和登录流程",
        "priority": "high",
        "start_time": "2025-08-16T23:59:15.934483",
        "status": "passed",
        "duration": 0.14077210426330566,
        "output": "2025-08-16 23:59:16,028 - INFO - 成功加载 13 个测试账号\n2025-08-16 23:59:16,029 - INFO - 认证测试器初始化完成，基础URL: http://localhost:8000\n2025-08-16 23:59:16,029 - INFO - 开始执行完整认证测试套件...\n2025-08-16 23:59:16,029 - INFO - 找到 11 个活跃测试账号\n2025-08-16 23:59:16,029 - INFO - 1. 测试有效登录...\n2025-08-16 23:59:16,034 - ERROR - 账号 admin_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,035 - ERROR - 账号 teacher_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,037 - ERROR - 账号 teacher_002 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,038 - ERROR - 账号 teacher_003 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,039 - ERROR - 账号 principal_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,040 - ERROR - 账号 director_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,041 - ERROR - 账号 student_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,042 - ERROR - 账号 student_002 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,043 - ERROR - 账号 parent_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,045 - ERROR - 账号 parent_002 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,046 - ERROR - 账号 guest_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,046 - INFO - 2. 测试无效凭据...\n2025-08-16 23:59:16,046 - INFO - 开始测试无效凭据...\n2025-08-16 23:59:16,047 - ERROR - 无效凭据测试失败: 完全无效的用户名和密码 - 期望4xx，实际: 404\n2025-08-16 23:59:16,048 - ERROR - 无效凭据测试失败: 有效用户名，无效密码 - 期望4xx，实际: 404\n2025-08-16 23:59:16,049 - ERROR - 无效凭据测试失败: 无效用户名，有效密码格式 - 期望4xx，实际: 404\n2025-08-16 23:59:16,050 - ERROR - 无效凭据测试失败: 空用户名 - 期望4xx，实际: 404\n2025-08-16 23:59:16,051 - ERROR - 无效凭据测试失败: 空密码 - 期望4xx，实际: 404\n2025-08-16 23:59:16,052 - ERROR - 无效凭据测试失败: 空用户名和密码 - 期望4xx，实际: 404\n2025-08-16 23:59:16,052 - INFO - 3. 测试会话验证...\n2025-08-16 23:59:16,052 - INFO - 4. 测试无效token访问...\n2025-08-16 23:59:16,052 - INFO - 测试无效token访问...\n2025-08-16 23:59:16,053 - ERROR - 无效token测试失败: invalid_token - 期望401，实际: 404\n2025-08-16 23:59:16,054 - ERROR - 无效token测试失败: Bearer invalid_token - 期望401，实际: 404\n2025-08-16 23:59:16,055 - ERROR - 无效token测试失败: expired_token_12345 - 期望401，实际: 404\n2025-08-16 23:59:16,056 - ERROR - 无效token测试失败: (empty) - 期望401，实际: 404\n2025-08-16 23:59:16,057 - ERROR - 无效token测试失败: malformed.token.here - 期望401，实际: 404\n2025-08-16 23:59:16,057 - INFO - 5. 测试并发登录...\n2025-08-16 23:59:16,057 - INFO - 开始并发登录测试，账号数: 5, 并发数: 5\n2025-08-16 23:59:16,060 - ERROR - 账号 teacher_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,060 - ERROR - 账号 admin_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,060 - ERROR - 账号 teacher_002 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,060 - ERROR - 账号 principal_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,060 - ERROR - 账号 teacher_003 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,061 - ERROR - 并发登录失败: admin_001 - {'success': False, 'error': 'HTTP 404: {\"detail\":\"Not Found\"}', 'response_time': 0.0022690296173095703}\n2025-08-16 23:59:16,061 - ERROR - 并发登录失败: teacher_001 - {'success': False, 'error': 'HTTP 404: {\"detail\":\"Not Found\"}', 'response_time': 0.0019872188568115234}\n2025-08-16 23:59:16,061 - ERROR - 并发登录失败: teacher_002 - {'success': False, 'error': 'HTTP 404: {\"detail\":\"Not Found\"}', 'response_time': 0.0022542476654052734}\n2025-08-16 23:59:16,061 - ERROR - 并发登录失败: teacher_003 - {'success': False, 'error': 'HTTP 404: {\"detail\":\"Not Found\"}', 'response_time': 0.002518892288208008}\n2025-08-16 23:59:16,061 - ERROR - 并发登录失败: principal_001 - {'success': False, 'error': 'HTTP 404: {\"detail\":\"Not Found\"}', 'response_time': 0.002212047576904297}\n2025-08-16 23:59:16,061 - INFO - 并发登录测试完成，成功: 0, 失败: 5, 总时间: 0.00s\n2025-08-16 23:59:16,061 - INFO - 6. 测试登出...\n2025-08-16 23:59:16,061 - INFO - 认证测试套件执行完成\n2025-08-16 23:59:16,061 - INFO - 登录成功率: 0.0%\n2025-08-16 23:59:16,061 - INFO - 会话验证成功率: 0.0%\n2025-08-16 23:59:16,061 - INFO - 登出成功率: 0.0%\n2025-08-16 23:59:16,061 - INFO - 无效凭据处理率: 0.0%\n2025-08-16 23:59:16,061 - INFO - 无效token处理: 失败\n2025-08-16 23:59:16,061 - INFO - 并发登录测试: 失败\n\n==================================================\n认证测试结果摘要\n==================================================\n测试账号总数: 11\n登录成功率: 0.0%\n会话验证成功率: 0.0%\n登出成功率: 0.0%\n无效凭据处理率: 0.0%\n无效token处理: ✗ 失败\n并发登录测试: ✗ 失败\n\n总体认证测试通过率: 0.0%\n\n详细测试结果已保存到: authentication_test_results.json\n测试日志已保存到: authentication_test.log\n",
        "error": "",
        "details": {
          "start_time": "2025-08-16T23:59:16.029207",
          "tests": {
            "valid_login": {
              "admin_001": {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.004995107650756836
              },
              "teacher_001": {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.0012180805206298828
              },
              "teacher_002": {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.0012159347534179688
              },
              "teacher_003": {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.0010540485382080078
              },
              "principal_001": {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.0009531974792480469
              },
              "director_001": {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.0010056495666503906
              },
              "student_001": {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.0009629726409912109
              },
              "student_002": {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.0009329319000244141
              },
              "parent_001": {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.0009081363677978516
              },
              "parent_002": {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.0009000301361083984
              },
              "guest_001": {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.0009670257568359375
              }
            },
            "invalid_credentials": [
              {
                "case": "完全无效的用户名和密码",
                "username": "invalid_user",
                "status_code": 404,
                "response_time": 0.0009419918060302734,
                "expected_failure": false,
                "success": false
              },
              {
                "case": "有效用户名，无效密码",
                "username": "admin",
                "status_code": 404,
                "response_time": 0.000965118408203125,
                "expected_failure": false,
                "success": false
              },
              {
                "case": "无效用户名，有效密码格式",
                "username": "wrong_user",
                "status_code": 404,
                "response_time": 0.0008649826049804688,
                "expected_failure": false,
                "success": false
              },
              {
                "case": "空用户名",
                "username": "",
                "status_code": 404,
                "response_time": 0.0008518695831298828,
                "expected_failure": false,
                "success": false
              },
              {
                "case": "空密码",
                "username": "admin",
                "status_code": 404,
                "response_time": 0.0008502006530761719,
                "expected_failure": false,
                "success": false
              },
              {
                "case": "空用户名和密码",
                "username": "",
                "status_code": 404,
                "response_time": 0.0009579658508300781,
                "expected_failure": false,
                "success": false
              }
            ],
            "session_validation": {},
            "invalid_token": {
              "results": [
                {
                  "token": "invalid_token",
                  "status_code": 404,
                  "response_time": 0.0009601116180419922,
                  "expected_failure": false,
                  "success": false
                },
                {
                  "token": "Bearer invalid_token",
                  "status_code": 404,
                  "response_time": 0.0008609294891357422,
                  "expected_failure": false,
                  "success": false
                },
                {
                  "token": "expired_token_12345",
                  "status_code": 404,
                  "response_time": 0.0008959770202636719,
                  "expected_failure": false,
                  "success": false
                },
                {
                  "token": "(empty)",
                  "status_code": 404,
                  "response_time": 0.0008490085601806641,
                  "expected_failure": false,
                  "success": false
                },
                {
                  "token": "malformed.token.here",
                  "status_code": 404,
                  "response_time": 0.0008640289306640625,
                  "expected_failure": false,
                  "success": false
                }
              ],
              "success": false
            },
            "concurrent_login": {
              "success": false,
              "total_accounts": 5,
              "successful_logins": 0,
              "failed_logins": 5,
              "total_time": 0.00304412841796875,
              "average_time": 0.00060882568359375,
              "results": [
                {
                  "success": false,
                  "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                  "response_time": 0.0022690296173095703
                },
                {
                  "success": false,
                  "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                  "response_time": 0.0019872188568115234
                },
                {
                  "success": false,
                  "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                  "response_time": 0.0022542476654052734
                },
                {
                  "success": false,
                  "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                  "response_time": 0.002518892288208008
                },
                {
                  "success": false,
                  "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                  "response_time": 0.002212047576904297
                }
              ]
            },
            "logout": {}
          },
          "summary": {
            "total_accounts": 11,
            "login_success_rate": 0.0,
            "session_validation_success_rate": 0,
            "logout_success_rate": 0,
            "invalid_credentials_handled": 0.0,
            "invalid_token_handled": false,
            "concurrent_login_success": false
          },
          "end_time": "2025-08-16T23:59:16.061130"
        },
        "return_code": 0,
        "end_time": "2025-08-16T23:59:16.075258"
      },
      {
        "test_name": "权限控制测试",
        "script": "test_authorization.py",
        "description": "测试不同角色的权限控制",
        "priority": "high",
        "start_time": "2025-08-16T23:59:18.077481",
        "status": "passed",
        "duration": 0.18638277053833008,
        "output": "2025-08-16 23:59:18,195 - INFO - 成功加载 13 个测试账号\n2025-08-16 23:59:18,195 - INFO - 权限控制测试器初始化完成，基础URL: http://localhost:8000\n2025-08-16 23:59:18,195 - INFO - 开始执行完整权限控制测试套件...\n2025-08-16 23:59:18,195 - INFO - 找到 11 个活跃测试账号\n2025-08-16 23:59:18,200 - ERROR - 账号 admin_001 认证失败，状态码: 404\n2025-08-16 23:59:18,201 - ERROR - 账号 teacher_001 认证失败，状态码: 404\n2025-08-16 23:59:18,203 - ERROR - 账号 teacher_002 认证失败，状态码: 404\n2025-08-16 23:59:18,204 - ERROR - 账号 teacher_003 认证失败，状态码: 404\n2025-08-16 23:59:18,205 - ERROR - 账号 principal_001 认证失败，状态码: 404\n2025-08-16 23:59:18,207 - ERROR - 账号 director_001 认证失败，状态码: 404\n2025-08-16 23:59:18,220 - ERROR - 账号 student_001 认证失败，状态码: 404\n2025-08-16 23:59:18,231 - ERROR - 账号 student_002 认证失败，状态码: 404\n2025-08-16 23:59:18,237 - ERROR - 账号 parent_001 认证失败，状态码: 404\n2025-08-16 23:59:18,238 - ERROR - 账号 parent_002 认证失败，状态码: 404\n2025-08-16 23:59:18,240 - ERROR - 账号 guest_001 认证失败，状态码: 404\n2025-08-16 23:59:18,240 - INFO - 成功认证 0 个账号\n2025-08-16 23:59:18,240 - INFO - 1. 测试角色权限...\n2025-08-16 23:59:18,240 - INFO - 2. 测试未授权访问...\n2025-08-16 23:59:18,240 - INFO - 测试未授权访问...\n2025-08-16 23:59:18,241 - ERROR - 未授权访问测试失败: /api/admin/users - 期望401，实际: 404\n2025-08-16 23:59:18,243 - ERROR - 未授权访问测试失败: /api/admin/system - 期望401，实际: 404\n2025-08-16 23:59:18,246 - ERROR - 未授权访问测试失败: /api/admin/logs - 期望401，实际: 404\n2025-08-16 23:59:18,247 - ERROR - 未授权访问测试失败: /api/school/statistics - 期望401，实际: 404\n2025-08-16 23:59:18,248 - ERROR - 未授权访问测试失败: /api/school/reports - 期望401，实际: 404\n2025-08-16 23:59:18,248 - INFO - 3. 测试跨角色访问...\n2025-08-16 23:59:18,248 - INFO - 测试跨角色访问...\n2025-08-16 23:59:18,248 - INFO - 4. 测试资源隔离...\n2025-08-16 23:59:18,248 - INFO - 测试资源隔离...\n2025-08-16 23:59:18,249 - INFO - 权限控制测试套件执行完成\n2025-08-16 23:59:18,249 - INFO - 角色权限测试成功率: 0.0%\n2025-08-16 23:59:18,249 - INFO - 未授权访问阻止率: 0.0%\n2025-08-16 23:59:18,249 - INFO - 跨角色访问成功率: 0.0%\n2025-08-16 23:59:18,249 - INFO - 资源隔离成功率: 0.0%\n\n==================================================\n权限控制测试结果摘要\n==================================================\n测试账号总数: 0\n测试端点总数: 23\n角色权限测试成功率: 0.0%\n未授权访问阻止率: 0.0%\n跨角色访问成功率: 0.0%\n资源隔离成功率: 0.0%\n\n总体权限控制测试通过率: 0.0%\n\n详细测试结果已保存到: authorization_test_results.json\n测试日志已保存到: authorization_test.log\n",
        "error": "",
        "details": {
          "start_time": "2025-08-16T23:59:18.195768",
          "tests": {
            "role_permissions": {},
            "unauthorized_access": [
              {
                "endpoint": "/api/admin/users",
                "method": "GET",
                "token": null,
                "status_code": 404,
                "response_time": 0.0012378692626953125,
                "success": false,
                "description": "无token访问测试"
              },
              {
                "endpoint": "/api/admin/system",
                "method": "GET",
                "token": null,
                "status_code": 404,
                "response_time": 0.0015180110931396484,
                "success": false,
                "description": "无token访问测试"
              },
              {
                "endpoint": "/api/admin/logs",
                "method": "GET",
                "token": null,
                "status_code": 404,
                "response_time": 0.001981019973754883,
                "success": false,
                "description": "无token访问测试"
              },
              {
                "endpoint": "/api/school/statistics",
                "method": "GET",
                "token": null,
                "status_code": 404,
                "response_time": 0.0012388229370117188,
                "success": false,
                "description": "无token访问测试"
              },
              {
                "endpoint": "/api/school/reports",
                "method": "GET",
                "token": null,
                "status_code": 404,
                "response_time": 0.0010459423065185547,
                "success": false,
                "description": "无token访问测试"
              }
            ],
            "cross_role_access": [
              {
                "success": false,
                "error": "未找到有效会话",
                "test_type": "高权限访问低权限资源"
              },
              {
                "success": false,
                "error": "未找到有效会话",
                "test_type": "高权限访问低权限资源"
              },
              {
                "success": false,
                "error": "未找到有效会话",
                "test_type": "高权限访问低权限资源"
              },
              {
                "success": false,
                "error": "未找到有效会话",
                "test_type": "低权限访问高权限资源"
              },
              {
                "success": false,
                "error": "未找到有效会话",
                "test_type": "低权限访问高权限资源"
              },
              {
                "success": false,
                "error": "未找到有效会话",
                "test_type": "低权限访问高权限资源"
              }
            ],
            "resource_isolation": [
              {
                "success": false,
                "error": "未找到有效会话",
                "test_type": "教师访问自己的资源"
              },
              {
                "success": false,
                "error": "未找到有效会话",
                "test_type": "教师访问自己的资源"
              },
              {
                "success": false,
                "error": "未找到有效会话",
                "test_type": "教师访问自己的资源"
              },
              {
                "success": false,
                "error": "未找到有效会话",
                "test_type": "学生访问教师资源"
              },
              {
                "success": false,
                "error": "未找到有效会话",
                "test_type": "学生访问教师资源"
              },
              {
                "success": false,
                "error": "未找到有效会话",
                "test_type": "学生访问教师资源"
              }
            ]
          },
          "summary": {
            "total_accounts": 0,
            "total_endpoints": 23,
            "role_permission_success_rate": 0,
            "unauthorized_access_blocked_rate": 0.0,
            "cross_role_access_success_rate": 0.0,
            "resource_isolation_success_rate": 0.0
          },
          "end_time": "2025-08-16T23:59:18.248984"
        },
        "return_code": 0,
        "end_time": "2025-08-16T23:59:18.263863"
      },
      {
        "test_name": "核心功能测试",
        "script": "test_core_functions.py",
        "description": "测试备课、上课、成绩管理等核心功能",
        "priority": "high",
        "start_time": "2025-08-16T23:59:20.265266",
        "status": "passed",
        "duration": 0.12752079963684082,
        "output": "2025-08-16 23:59:20,360 - INFO - 成功加载 13 个测试账号\n2025-08-16 23:59:20,360 - INFO - 核心功能测试器初始化完成，基础URL: http://localhost:8000\n2025-08-16 23:59:20,360 - INFO - 开始执行完整核心功能测试套件...\n2025-08-16 23:59:20,360 - INFO - 找到 11 个活跃测试账号\n2025-08-16 23:59:20,365 - ERROR - 账号 admin_001 认证失败，状态码: 404\n2025-08-16 23:59:20,367 - ERROR - 账号 teacher_001 认证失败，状态码: 404\n2025-08-16 23:59:20,368 - ERROR - 账号 teacher_002 认证失败，状态码: 404\n2025-08-16 23:59:20,369 - ERROR - 账号 teacher_003 认证失败，状态码: 404\n2025-08-16 23:59:20,371 - ERROR - 账号 principal_001 认证失败，状态码: 404\n2025-08-16 23:59:20,372 - ERROR - 账号 director_001 认证失败，状态码: 404\n2025-08-16 23:59:20,374 - ERROR - 账号 student_001 认证失败，状态码: 404\n2025-08-16 23:59:20,375 - ERROR - 账号 student_002 认证失败，状态码: 404\n2025-08-16 23:59:20,376 - ERROR - 账号 parent_001 认证失败，状态码: 404\n2025-08-16 23:59:20,377 - ERROR - 账号 parent_002 认证失败，状态码: 404\n2025-08-16 23:59:20,379 - ERROR - 账号 guest_001 认证失败，状态码: 404\n2025-08-16 23:59:20,379 - INFO - 成功认证 0 个账号\n2025-08-16 23:59:20,379 - INFO - 核心功能测试套件执行完成\n2025-08-16 23:59:20,379 - INFO - 总体成功率: 0.0%\n\n==================================================\n核心功能测试结果摘要\n==================================================\n测试账号总数: 0\n测试用例总数: 0\n成功测试数: 0\n总体成功率: 0.0%\n\n各角色测试结果:\n\n详细测试结果已保存到: core_functions_test_results.json\n测试日志已保存到: core_functions_test.log\n",
        "error": "",
        "details": {
          "start_time": "2025-08-16T23:59:20.360958",
          "tests": {
            "role_functions": {}
          },
          "summary": {
            "total_accounts": 0,
            "total_tests": 0,
            "successful_tests": 0,
            "overall_success_rate": 0,
            "role_statistics": {}
          },
          "end_time": "2025-08-16T23:59:20.379312"
        },
        "return_code": 0,
        "end_time": "2025-08-16T23:59:20.392787"
      },
      {
        "test_name": "数据流测试",
        "script": "test_data_flow.py",
        "description": "测试客户端-服务端数据流",
        "priority": "high",
        "start_time": "2025-08-16T23:59:22.393360",
        "status": "failed",
        "duration": 0.14108705520629883,
        "output": "2025-08-16 23:59:22,499 - INFO - 成功加载 13 个测试账号\n2025-08-16 23:59:22,500 - INFO - 初始化测试数据: 50 学生, 20 考试, 1000 成绩记录\n2025-08-16 23:59:22,500 - INFO - 数据流测试器初始化完成，基础URL: http://localhost:8000\n2025-08-16 23:59:22,500 - INFO - 开始执行完整数据流测试套件...\n2025-08-16 23:59:22,500 - INFO - 找到 11 个活跃测试账号\n2025-08-16 23:59:22,504 - ERROR - 账号 admin_001 认证失败，状态码: 404\n2025-08-16 23:59:22,506 - ERROR - 账号 teacher_001 认证失败，状态码: 404\n2025-08-16 23:59:22,507 - ERROR - 账号 teacher_002 认证失败，状态码: 404\n2025-08-16 23:59:22,509 - ERROR - 账号 teacher_003 认证失败，状态码: 404\n2025-08-16 23:59:22,510 - ERROR - 账号 principal_001 认证失败，状态码: 404\n2025-08-16 23:59:22,512 - ERROR - 账号 director_001 认证失败，状态码: 404\n2025-08-16 23:59:22,513 - ERROR - 账号 student_001 认证失败，状态码: 404\n2025-08-16 23:59:22,514 - ERROR - 账号 student_002 认证失败，状态码: 404\n2025-08-16 23:59:22,515 - ERROR - 账号 parent_001 认证失败，状态码: 404\n2025-08-16 23:59:22,517 - ERROR - 账号 parent_002 认证失败，状态码: 404\n2025-08-16 23:59:22,518 - ERROR - 账号 guest_001 认证失败，状态码: 404\n2025-08-16 23:59:22,518 - INFO - 成功认证 0 个账号\n2025-08-16 23:59:22,518 - ERROR - 没有成功认证的账号，无法进行数据流测试\n\n==================================================\n数据流测试结果摘要\n==================================================\n2025-08-16 23:59:22,518 - ERROR - 数据流测试执行失败: 'total_accounts_tested'\n",
        "error": "Traceback (most recent call last):\n  File \"/Users/tangxiaolu/project/PythonProject/aiLearn/learn05/service/tests/test_data_flow.py\", line 702, in <module>\n    asyncio.run(main())\n    ~~~~~~~~~~~^^^^^^^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py\", line 194, in run\n    return runner.run(main)\n           ~~~~~~~~~~^^^^^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py\", line 118, in run\n    return self._loop.run_until_complete(task)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py\", line 721, in run_until_complete\n    return future.result()\n           ~~~~~~~~~~~~~^^\n  File \"/Users/tangxiaolu/project/PythonProject/aiLearn/learn05/service/tests/test_data_flow.py\", line 678, in main\n    print(f\"测试账号总数: {summary['total_accounts_tested']}\")\n                           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'total_accounts_tested'\n",
        "details": {},
        "return_code": 1,
        "end_time": "2025-08-16T23:59:22.534445"
      },
      {
        "test_name": "安全性测试",
        "script": "test_security.py",
        "description": "测试系统安全性",
        "priority": "high",
        "start_time": "2025-08-16T23:59:24.535817",
        "status": "passed",
        "duration": 5.209529161453247,
        "output": "2025-08-16 23:59:24,651 - INFO - 成功加载 13 个测试账号\n2025-08-16 23:59:24,652 - INFO - 安全性测试器初始化完成，基础URL: http://localhost:8000\n2025-08-16 23:59:24,652 - INFO - 开始执行完整安全性测试套件...\n2025-08-16 23:59:24,652 - INFO - 执行认证安全性测试...\n2025-08-16 23:59:24,652 - INFO - 开始测试认证安全性...\n2025-08-16 23:59:24,652 - INFO - 测试弱密码登录...\n2025-08-16 23:59:24,663 - INFO - 测试暴力破解防护...\n2025-08-16 23:59:29,707 - INFO - 测试SQL注入攻击...\n2025-08-16 23:59:29,716 - INFO - 测试会话固定攻击...\n2025-08-16 23:59:29,718 - INFO - 执行权限控制安全性测试...\n2025-08-16 23:59:29,718 - INFO - 开始测试权限控制安全性...\n2025-08-16 23:59:29,718 - INFO - 测试垂直权限提升...\n2025-08-16 23:59:29,718 - INFO - 测试水平权限提升...\n2025-08-16 23:59:29,718 - INFO - 测试未授权访问...\n2025-08-16 23:59:29,721 - INFO - 测试令牌篡改...\n2025-08-16 23:59:29,721 - INFO - 执行输入验证安全性测试...\n2025-08-16 23:59:29,721 - INFO - 开始测试输入验证安全性...\n2025-08-16 23:59:29,721 - ERROR - 没有找到活跃的教师账号\n2025-08-16 23:59:29,721 - INFO - 执行会话管理安全性测试...\n2025-08-16 23:59:29,721 - INFO - 开始测试会话管理安全性...\n2025-08-16 23:59:29,721 - INFO - 测试会话超时...\n2025-08-16 23:59:29,722 - INFO - 测试会话注销...\n2025-08-16 23:59:29,723 - INFO - 测试并发会话...\n2025-08-16 23:59:29,727 - INFO - 安全性测试套件执行完成\n2025-08-16 23:59:29,727 - INFO - 总体安全评分: 72.5分 (一般)\n2025-08-16 23:59:29,727 - INFO - 发现漏洞总数: 1 (高风险: 0, 中风险: 1, 低风险: 0)\n\n==================================================\n安全性测试结果摘要\n==================================================\n总体安全评分: 72.5分\n安全等级: 一般\n发现漏洞总数: 1\n\n漏洞分布:\n  高风险漏洞: 0个\n  中风险漏洞: 1个\n  低风险漏洞: 0个\n\n各项安全评分:\n  认证安全: 90.0分\n  权限控制: 100.0分\n  输入验证: 0.0分\n  会话管理: 100.0分\n\n安全建议:\n  1. 实施账号锁定和验证码机制防止暴力破解\n  2. 定期进行安全审计和渗透测试\n  3. 保持系统和依赖库的及时更新\n  4. 实施安全日志记录和监控\n  5. 对敏感数据进行加密存储和传输\n\n详细测试结果已保存到: security_test_results.json\n测试日志已保存到: security_test.log\n",
        "error": "",
        "details": {
          "start_time": "2025-08-16T23:59:24.652332",
          "tests": {
            "authentication_security": {
              "test_type": "认证安全性测试",
              "tests": {
                "weak_password_test": [
                  {
                    "password": "123456",
                    "login_successful": false
                  },
                  {
                    "password": "password",
                    "login_successful": false
                  },
                  {
                    "password": "admin",
                    "login_successful": false
                  },
                  {
                    "password": "123123",
                    "login_successful": false
                  },
                  {
                    "password": "qwerty",
                    "login_successful": false
                  },
                  {
                    "password": "abc123",
                    "login_successful": false
                  }
                ],
                "brute_force_protection": {
                  "total_attempts": 10,
                  "blocked_attempts": 0,
                  "protection_exists": false,
                  "attempts_details": [
                    {
                      "attempt": 1,
                      "status_code": 404,
                      "response_time": 0.0011529922485351562,
                      "blocked": false
                    },
                    {
                      "attempt": 2,
                      "status_code": 404,
                      "response_time": 0.005496978759765625,
                      "blocked": false
                    },
                    {
                      "attempt": 3,
                      "status_code": 404,
                      "response_time": 0.004224061965942383,
                      "blocked": false
                    },
                    {
                      "attempt": 4,
                      "status_code": 404,
                      "response_time": 0.0037279129028320312,
                      "blocked": false
                    },
                    {
                      "attempt": 5,
                      "status_code": 404,
                      "response_time": 0.0019321441650390625,
                      "blocked": false
                    },
                    {
                      "attempt": 6,
                      "status_code": 404,
                      "response_time": 0.0017371177673339844,
                      "blocked": false
                    },
                    {
                      "attempt": 7,
                      "status_code": 404,
                      "response_time": 0.0023550987243652344,
                      "blocked": false
                    },
                    {
                      "attempt": 8,
                      "status_code": 404,
                      "response_time": 0.0027370452880859375,
                      "blocked": false
                    },
                    {
                      "attempt": 9,
                      "status_code": 404,
                      "response_time": 0.0017368793487548828,
                      "blocked": false
                    },
                    {
                      "attempt": 10,
                      "status_code": 404,
                      "response_time": 0.005088090896606445,
                      "blocked": false
                    }
                  ]
                },
                "sql_injection_test": [
                  {
                    "payload": "' OR '1'='1",
                    "status_code": 404,
                    "sql_error_exposed": false,
                    "login_successful": false
                  },
                  {
                    "payload": "'; DROP TABLE users; --",
                    "status_code": 404,
                    "sql_error_exposed": false,
                    "login_successful": false
                  },
                  {
                    "payload": "' UNION SELECT * FROM users --",
                    "status_code": 404,
                    "sql_error_exposed": false,
                    "login_successful": false
                  },
                  {
                    "payload": "admin'--",
                    "status_code": 404,
                    "sql_error_exposed": false,
                    "login_successful": false
                  },
                  {
                    "payload": "' OR 1=1#",
                    "status_code": 404,
                    "sql_error_exposed": false,
                    "login_successful": false
                  },
                  {
                    "payload": "1' AND (SELECT COUNT(*) FROM users) > 0 --",
                    "status_code": 404,
                    "sql_error_exposed": false,
                    "login_successful": false
                  }
                ],
                "session_fixation_test": []
              },
              "vulnerabilities": [
                "缺少暴力破解防护机制"
              ],
              "security_score": 90.0,
              "security_rating": "优秀"
            },
            "authorization_security": {
              "test_type": "权限控制安全性测试",
              "tests": {
                "vertical_privilege_escalation": [],
                "horizontal_privilege_escalation": [],
                "unauthorized_access": [
                  {
                    "endpoint": "/api/user/profile",
                    "unauthorized_access_granted": false,
                    "status_code": 404
                  },
                  {
                    "endpoint": "/api/grades/list",
                    "unauthorized_access_granted": false,
                    "status_code": 404
                  },
                  {
                    "endpoint": "/api/lesson/list",
                    "unauthorized_access_granted": false,
                    "status_code": 404
                  },
                  {
                    "endpoint": "/api/admin/users",
                    "unauthorized_access_granted": false,
                    "status_code": 404
                  },
                  {
                    "endpoint": "/api/student/progress",
                    "unauthorized_access_granted": false,
                    "status_code": 404
                  }
                ],
                "token_tampering": []
              },
              "vulnerabilities": [],
              "security_score": 100.0,
              "security_rating": "优秀"
            },
            "input_validation_security": {
              "test_type": "输入验证安全性测试",
              "tests": {},
              "vulnerabilities": [],
              "security_score": 0
            },
            "session_management_security": {
              "test_type": "会话管理安全性测试",
              "tests": {
                "session_timeout_test": [],
                "session_logout_test": [],
                "concurrent_session_test": [
                  {
                    "total_sessions_created": 0,
                    "valid_concurrent_sessions": 0,
                    "multiple_sessions_allowed": false
                  }
                ]
              },
              "vulnerabilities": [],
              "security_score": 100.0,
              "security_rating": "优秀"
            }
          },
          "summary": {
            "total_vulnerabilities": 1,
            "high_risk_vulnerabilities": 0,
            "medium_risk_vulnerabilities": 1,
            "low_risk_vulnerabilities": 0,
            "security_scores": {
              "authentication": 90.0,
              "authorization": 100.0,
              "input_validation": 0,
              "session_management": 100.0
            },
            "overall_security_score": 72.5,
            "security_level": "一般",
            "vulnerability_details": {
              "high_risk": [],
              "medium_risk": [
                "缺少暴力破解防护机制"
              ],
              "low_risk": []
            },
            "security_recommendations": [
              "实施账号锁定和验证码机制防止暴力破解",
              "定期进行安全审计和渗透测试",
              "保持系统和依赖库的及时更新",
              "实施安全日志记录和监控",
              "对敏感数据进行加密存储和传输"
            ]
          },
          "overall_vulnerabilities": [
            "缺少暴力破解防护机制"
          ],
          "end_time": "2025-08-16T23:59:29.727346"
        },
        "return_code": 0,
        "end_time": "2025-08-16T23:59:29.745346"
      }
    ],
    "medium": [
      {
        "test_name": "并发访问测试",
        "script": "test_concurrent_access.py",
        "description": "测试多用户并发访问",
        "priority": "medium",
        "start_time": "2025-08-16T23:59:31.746477",
        "status": "passed",
        "duration": 37.24011707305908,
        "output": "2025-08-16 23:59:31,850 - INFO - 成功加载 13 个测试账号\n2025-08-16 23:59:31,850 - INFO - 并发访问测试器初始化完成，基础URL: http://localhost:8000\n2025-08-16 23:59:31,851 - INFO - 开始执行完整并发访问测试套件...\n2025-08-16 23:59:31,851 - INFO - 找到 11 个活跃测试账号\n2025-08-16 23:59:31,851 - INFO - 执行并发登录测试...\n2025-08-16 23:59:31,851 - INFO - 开始测试 10 个账号的并发登录...\n2025-08-16 23:59:31,858 - INFO - 执行并发API调用测试...\n2025-08-16 23:59:31,867 - INFO - 开始测试 8 个账号的并发API调用，持续 30 秒...\n2025-08-17 00:00:02,933 - INFO - 执行资源竞争测试...\n2025-08-17 00:00:02,934 - INFO - 开始测试 6 个账号的资源竞争...\n2025-08-17 00:00:02,934 - INFO - 执行系统负载能力测试...\n2025-08-17 00:00:02,934 - INFO - 开始测试系统负载能力，最大用户数: 11...\n2025-08-17 00:00:02,934 - INFO - 测试 3 个并发用户...\n2025-08-17 00:00:02,934 - INFO - 开始测试 3 个账号的并发登录...\n2025-08-17 00:00:04,940 - INFO - 测试 6 个并发用户...\n2025-08-17 00:00:04,940 - INFO - 开始测试 6 个账号的并发登录...\n2025-08-17 00:00:06,954 - INFO - 测试 9 个并发用户...\n2025-08-17 00:00:06,954 - INFO - 开始测试 9 个账号的并发登录...\n2025-08-17 00:00:08,962 - INFO - 并发访问测试套件执行完成\n2025-08-17 00:00:08,962 - INFO - 总体并发性能评分: 0.0分 (需要改进)\n2025-08-17 00:00:08,962 - INFO - 最大稳定用户数: 0\n\n==================================================\n并发访问测试结果摘要\n==================================================\n可用测试账号: 11\n总体性能评分: 0.0分\n性能等级: 需要改进\n\n各项测试结果:\n  并发登录: 0.0% (平均 0.00s)\n  并发API调用: 0.0% (6.2 req/s)\n  资源竞争: 0.0%\n  负载能力: 最大稳定用户数 0 (较差)\n\n详细测试结果已保存到: concurrent_access_test_results.json\n测试日志已保存到: concurrent_access_test.log\n",
        "error": "",
        "details": {
          "start_time": "2025-08-16T23:59:31.851028",
          "tests": {
            "concurrent_login": {
              "test_type": "并发登录测试",
              "total_accounts": 10,
              "successful_logins": 0,
              "failed_logins": 10,
              "success_rate": 0.0,
              "total_time": 0.00720524787902832,
              "avg_login_time": 0,
              "max_login_time": 0,
              "min_login_time": 0,
              "role_statistics": {
                "系统管理员": {
                  "successful": 0,
                  "failed": 1
                },
                "教师": {
                  "successful": 0,
                  "failed": 3
                },
                "校长": {
                  "successful": 0,
                  "failed": 1
                },
                "教务主任": {
                  "successful": 0,
                  "failed": 1
                },
                "学生": {
                  "successful": 0,
                  "failed": 2
                },
                "家长": {
                  "successful": 0,
                  "failed": 2
                }
              },
              "concurrent_level": 10
            },
            "concurrent_api_calls": {
              "test_type": "并发API调用测试",
              "test_duration": 31.065863847732544,
              "concurrent_users": 8,
              "total_requests": 194,
              "successful_requests": 0,
              "failed_requests": 194,
              "success_rate": 0.0,
              "requests_per_second": 6.244796569986892,
              "avg_response_time": 0,
              "max_response_time": 0,
              "min_response_time": 0,
              "endpoint_statistics": {
                "未知": {
                  "total": 194,
                  "successful": 0,
                  "failed": 194
                }
              },
              "status_code_distribution": {}
            },
            "resource_competition": {
              "test_type": "资源竞争测试",
              "resource_id": "shared_resource_001",
              "concurrent_users": 6,
              "total_operations": 30,
              "successful_operations": 0,
              "failed_operations": 30,
              "overall_success_rate": 0.0,
              "read_operations": {
                "total": 18,
                "successful": 0,
                "success_rate": 0.0
              },
              "write_operations": {
                "total": 12,
                "successful": 0,
                "success_rate": 0.0
              },
              "test_duration": 0.00024080276489257812
            },
            "load_capacity": {
              "test_type": "系统负载能力测试",
              "max_tested_users": 11,
              "max_stable_users": 0,
              "performance_degradation_point": 3,
              "load_test_details": [
                {
                  "concurrent_users": 3,
                  "login_success_rate": 0.0,
                  "api_success_rate": 0,
                  "avg_response_time": 0,
                  "requests_per_second": 0,
                  "system_stable": false,
                  "note": "登录成功率过低，跳过API测试"
                },
                {
                  "concurrent_users": 6,
                  "login_success_rate": 0.0,
                  "api_success_rate": 0,
                  "avg_response_time": 0,
                  "requests_per_second": 0,
                  "system_stable": false,
                  "note": "登录成功率过低，跳过API测试"
                },
                {
                  "concurrent_users": 9,
                  "login_success_rate": 0.0,
                  "api_success_rate": 0,
                  "avg_response_time": 0,
                  "requests_per_second": 0,
                  "system_stable": false,
                  "note": "登录成功率过低，跳过API测试"
                }
              ],
              "system_capacity_rating": "较差"
            }
          },
          "summary": {
            "total_accounts_available": 11,
            "concurrent_login": {
              "success_rate": 0.0,
              "avg_login_time": 0,
              "concurrent_level": 10
            },
            "concurrent_api_calls": {
              "success_rate": 0.0,
              "requests_per_second": 6.244796569986892,
              "avg_response_time": 0
            },
            "resource_competition": {
              "overall_success_rate": 0.0,
              "read_success_rate": 0.0,
              "write_success_rate": 0.0
            },
            "load_capacity": {
              "max_stable_users": 0,
              "system_capacity_rating": "较差"
            },
            "overall_concurrent_performance_score": 0.0,
            "performance_rating": "需要改进"
          },
          "end_time": "2025-08-17T00:00:08.961548"
        },
        "return_code": 0,
        "end_time": "2025-08-17T00:00:08.986596"
      },
      {
        "test_name": "性能测试",
        "script": "test_performance.py",
        "description": "测试系统性能表现",
        "priority": "medium",
        "start_time": "2025-08-17T00:00:10.988810",
        "status": "passed",
        "duration": 0.18930816650390625,
        "output": "2025-08-17 00:00:11,164 - INFO - 成功加载 13 个测试账号\n2025-08-17 00:00:11,165 - INFO - 性能测试器初始化完成，基础URL: http://localhost:8000\n2025-08-17 00:00:11,165 - INFO - 开始执行完整性能测试套件...\n2025-08-17 00:00:11,165 - ERROR - 没有找到活跃的教师账号\n\n==================================================\n性能测试结果摘要\n==================================================\n\n详细测试结果已保存到: performance_test_results.json\n测试日志已保存到: performance_test.log\n",
        "error": "",
        "details": {},
        "return_code": 0,
        "end_time": "2025-08-17T00:00:11.178111"
      }
    ],
    "low": []
  },
  "detailed_test_results": {
    "test_authentication.py": {
      "test_name": "认证流程测试",
      "script": "test_authentication.py",
      "description": "测试用户认证和登录流程",
      "priority": "high",
      "start_time": "2025-08-16T23:59:15.934483",
      "status": "passed",
      "duration": 0.14077210426330566,
      "output": "2025-08-16 23:59:16,028 - INFO - 成功加载 13 个测试账号\n2025-08-16 23:59:16,029 - INFO - 认证测试器初始化完成，基础URL: http://localhost:8000\n2025-08-16 23:59:16,029 - INFO - 开始执行完整认证测试套件...\n2025-08-16 23:59:16,029 - INFO - 找到 11 个活跃测试账号\n2025-08-16 23:59:16,029 - INFO - 1. 测试有效登录...\n2025-08-16 23:59:16,034 - ERROR - 账号 admin_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,035 - ERROR - 账号 teacher_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,037 - ERROR - 账号 teacher_002 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,038 - ERROR - 账号 teacher_003 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,039 - ERROR - 账号 principal_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,040 - ERROR - 账号 director_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,041 - ERROR - 账号 student_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,042 - ERROR - 账号 student_002 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,043 - ERROR - 账号 parent_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,045 - ERROR - 账号 parent_002 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,046 - ERROR - 账号 guest_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,046 - INFO - 2. 测试无效凭据...\n2025-08-16 23:59:16,046 - INFO - 开始测试无效凭据...\n2025-08-16 23:59:16,047 - ERROR - 无效凭据测试失败: 完全无效的用户名和密码 - 期望4xx，实际: 404\n2025-08-16 23:59:16,048 - ERROR - 无效凭据测试失败: 有效用户名，无效密码 - 期望4xx，实际: 404\n2025-08-16 23:59:16,049 - ERROR - 无效凭据测试失败: 无效用户名，有效密码格式 - 期望4xx，实际: 404\n2025-08-16 23:59:16,050 - ERROR - 无效凭据测试失败: 空用户名 - 期望4xx，实际: 404\n2025-08-16 23:59:16,051 - ERROR - 无效凭据测试失败: 空密码 - 期望4xx，实际: 404\n2025-08-16 23:59:16,052 - ERROR - 无效凭据测试失败: 空用户名和密码 - 期望4xx，实际: 404\n2025-08-16 23:59:16,052 - INFO - 3. 测试会话验证...\n2025-08-16 23:59:16,052 - INFO - 4. 测试无效token访问...\n2025-08-16 23:59:16,052 - INFO - 测试无效token访问...\n2025-08-16 23:59:16,053 - ERROR - 无效token测试失败: invalid_token - 期望401，实际: 404\n2025-08-16 23:59:16,054 - ERROR - 无效token测试失败: Bearer invalid_token - 期望401，实际: 404\n2025-08-16 23:59:16,055 - ERROR - 无效token测试失败: expired_token_12345 - 期望401，实际: 404\n2025-08-16 23:59:16,056 - ERROR - 无效token测试失败: (empty) - 期望401，实际: 404\n2025-08-16 23:59:16,057 - ERROR - 无效token测试失败: malformed.token.here - 期望401，实际: 404\n2025-08-16 23:59:16,057 - INFO - 5. 测试并发登录...\n2025-08-16 23:59:16,057 - INFO - 开始并发登录测试，账号数: 5, 并发数: 5\n2025-08-16 23:59:16,060 - ERROR - 账号 teacher_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,060 - ERROR - 账号 admin_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,060 - ERROR - 账号 teacher_002 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,060 - ERROR - 账号 principal_001 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,060 - ERROR - 账号 teacher_003 登录失败，状态码: 404, 错误: {\"detail\":\"Not Found\"}\n2025-08-16 23:59:16,061 - ERROR - 并发登录失败: admin_001 - {'success': False, 'error': 'HTTP 404: {\"detail\":\"Not Found\"}', 'response_time': 0.0022690296173095703}\n2025-08-16 23:59:16,061 - ERROR - 并发登录失败: teacher_001 - {'success': False, 'error': 'HTTP 404: {\"detail\":\"Not Found\"}', 'response_time': 0.0019872188568115234}\n2025-08-16 23:59:16,061 - ERROR - 并发登录失败: teacher_002 - {'success': False, 'error': 'HTTP 404: {\"detail\":\"Not Found\"}', 'response_time': 0.0022542476654052734}\n2025-08-16 23:59:16,061 - ERROR - 并发登录失败: teacher_003 - {'success': False, 'error': 'HTTP 404: {\"detail\":\"Not Found\"}', 'response_time': 0.002518892288208008}\n2025-08-16 23:59:16,061 - ERROR - 并发登录失败: principal_001 - {'success': False, 'error': 'HTTP 404: {\"detail\":\"Not Found\"}', 'response_time': 0.002212047576904297}\n2025-08-16 23:59:16,061 - INFO - 并发登录测试完成，成功: 0, 失败: 5, 总时间: 0.00s\n2025-08-16 23:59:16,061 - INFO - 6. 测试登出...\n2025-08-16 23:59:16,061 - INFO - 认证测试套件执行完成\n2025-08-16 23:59:16,061 - INFO - 登录成功率: 0.0%\n2025-08-16 23:59:16,061 - INFO - 会话验证成功率: 0.0%\n2025-08-16 23:59:16,061 - INFO - 登出成功率: 0.0%\n2025-08-16 23:59:16,061 - INFO - 无效凭据处理率: 0.0%\n2025-08-16 23:59:16,061 - INFO - 无效token处理: 失败\n2025-08-16 23:59:16,061 - INFO - 并发登录测试: 失败\n\n==================================================\n认证测试结果摘要\n==================================================\n测试账号总数: 11\n登录成功率: 0.0%\n会话验证成功率: 0.0%\n登出成功率: 0.0%\n无效凭据处理率: 0.0%\n无效token处理: ✗ 失败\n并发登录测试: ✗ 失败\n\n总体认证测试通过率: 0.0%\n\n详细测试结果已保存到: authentication_test_results.json\n测试日志已保存到: authentication_test.log\n",
      "error": "",
      "details": {
        "start_time": "2025-08-16T23:59:16.029207",
        "tests": {
          "valid_login": {
            "admin_001": {
              "success": false,
              "error": "HTTP 404: {\"detail\":\"Not Found\"}",
              "response_time": 0.004995107650756836
            },
            "teacher_001": {
              "success": false,
              "error": "HTTP 404: {\"detail\":\"Not Found\"}",
              "response_time": 0.0012180805206298828
            },
            "teacher_002": {
              "success": false,
              "error": "HTTP 404: {\"detail\":\"Not Found\"}",
              "response_time": 0.0012159347534179688
            },
            "teacher_003": {
              "success": false,
              "error": "HTTP 404: {\"detail\":\"Not Found\"}",
              "response_time": 0.0010540485382080078
            },
            "principal_001": {
              "success": false,
              "error": "HTTP 404: {\"detail\":\"Not Found\"}",
              "response_time": 0.0009531974792480469
            },
            "director_001": {
              "success": false,
              "error": "HTTP 404: {\"detail\":\"Not Found\"}",
              "response_time": 0.0010056495666503906
            },
            "student_001": {
              "success": false,
              "error": "HTTP 404: {\"detail\":\"Not Found\"}",
              "response_time": 0.0009629726409912109
            },
            "student_002": {
              "success": false,
              "error": "HTTP 404: {\"detail\":\"Not Found\"}",
              "response_time": 0.0009329319000244141
            },
            "parent_001": {
              "success": false,
              "error": "HTTP 404: {\"detail\":\"Not Found\"}",
              "response_time": 0.0009081363677978516
            },
            "parent_002": {
              "success": false,
              "error": "HTTP 404: {\"detail\":\"Not Found\"}",
              "response_time": 0.0009000301361083984
            },
            "guest_001": {
              "success": false,
              "error": "HTTP 404: {\"detail\":\"Not Found\"}",
              "response_time": 0.0009670257568359375
            }
          },
          "invalid_credentials": [
            {
              "case": "完全无效的用户名和密码",
              "username": "invalid_user",
              "status_code": 404,
              "response_time": 0.0009419918060302734,
              "expected_failure": false,
              "success": false
            },
            {
              "case": "有效用户名，无效密码",
              "username": "admin",
              "status_code": 404,
              "response_time": 0.000965118408203125,
              "expected_failure": false,
              "success": false
            },
            {
              "case": "无效用户名，有效密码格式",
              "username": "wrong_user",
              "status_code": 404,
              "response_time": 0.0008649826049804688,
              "expected_failure": false,
              "success": false
            },
            {
              "case": "空用户名",
              "username": "",
              "status_code": 404,
              "response_time": 0.0008518695831298828,
              "expected_failure": false,
              "success": false
            },
            {
              "case": "空密码",
              "username": "admin",
              "status_code": 404,
              "response_time": 0.0008502006530761719,
              "expected_failure": false,
              "success": false
            },
            {
              "case": "空用户名和密码",
              "username": "",
              "status_code": 404,
              "response_time": 0.0009579658508300781,
              "expected_failure": false,
              "success": false
            }
          ],
          "session_validation": {},
          "invalid_token": {
            "results": [
              {
                "token": "invalid_token",
                "status_code": 404,
                "response_time": 0.0009601116180419922,
                "expected_failure": false,
                "success": false
              },
              {
                "token": "Bearer invalid_token",
                "status_code": 404,
                "response_time": 0.0008609294891357422,
                "expected_failure": false,
                "success": false
              },
              {
                "token": "expired_token_12345",
                "status_code": 404,
                "response_time": 0.0008959770202636719,
                "expected_failure": false,
                "success": false
              },
              {
                "token": "(empty)",
                "status_code": 404,
                "response_time": 0.0008490085601806641,
                "expected_failure": false,
                "success": false
              },
              {
                "token": "malformed.token.here",
                "status_code": 404,
                "response_time": 0.0008640289306640625,
                "expected_failure": false,
                "success": false
              }
            ],
            "success": false
          },
          "concurrent_login": {
            "success": false,
            "total_accounts": 5,
            "successful_logins": 0,
            "failed_logins": 5,
            "total_time": 0.00304412841796875,
            "average_time": 0.00060882568359375,
            "results": [
              {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.0022690296173095703
              },
              {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.0019872188568115234
              },
              {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.0022542476654052734
              },
              {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.002518892288208008
              },
              {
                "success": false,
                "error": "HTTP 404: {\"detail\":\"Not Found\"}",
                "response_time": 0.002212047576904297
              }
            ]
          },
          "logout": {}
        },
        "summary": {
          "total_accounts": 11,
          "login_success_rate": 0.0,
          "session_validation_success_rate": 0,
          "logout_success_rate": 0,
          "invalid_credentials_handled": 0.0,
          "invalid_token_handled": false,
          "concurrent_login_success": false
        },
        "end_time": "2025-08-16T23:59:16.061130"
      },
      "return_code": 0,
      "end_time": "2025-08-16T23:59:16.075258"
    },
    "test_authorization.py": {
      "test_name": "权限控制测试",
      "script": "test_authorization.py",
      "description": "测试不同角色的权限控制",
      "priority": "high",
      "start_time": "2025-08-16T23:59:18.077481",
      "status": "passed",
      "duration": 0.18638277053833008,
      "output": "2025-08-16 23:59:18,195 - INFO - 成功加载 13 个测试账号\n2025-08-16 23:59:18,195 - INFO - 权限控制测试器初始化完成，基础URL: http://localhost:8000\n2025-08-16 23:59:18,195 - INFO - 开始执行完整权限控制测试套件...\n2025-08-16 23:59:18,195 - INFO - 找到 11 个活跃测试账号\n2025-08-16 23:59:18,200 - ERROR - 账号 admin_001 认证失败，状态码: 404\n2025-08-16 23:59:18,201 - ERROR - 账号 teacher_001 认证失败，状态码: 404\n2025-08-16 23:59:18,203 - ERROR - 账号 teacher_002 认证失败，状态码: 404\n2025-08-16 23:59:18,204 - ERROR - 账号 teacher_003 认证失败，状态码: 404\n2025-08-16 23:59:18,205 - ERROR - 账号 principal_001 认证失败，状态码: 404\n2025-08-16 23:59:18,207 - ERROR - 账号 director_001 认证失败，状态码: 404\n2025-08-16 23:59:18,220 - ERROR - 账号 student_001 认证失败，状态码: 404\n2025-08-16 23:59:18,231 - ERROR - 账号 student_002 认证失败，状态码: 404\n2025-08-16 23:59:18,237 - ERROR - 账号 parent_001 认证失败，状态码: 404\n2025-08-16 23:59:18,238 - ERROR - 账号 parent_002 认证失败，状态码: 404\n2025-08-16 23:59:18,240 - ERROR - 账号 guest_001 认证失败，状态码: 404\n2025-08-16 23:59:18,240 - INFO - 成功认证 0 个账号\n2025-08-16 23:59:18,240 - INFO - 1. 测试角色权限...\n2025-08-16 23:59:18,240 - INFO - 2. 测试未授权访问...\n2025-08-16 23:59:18,240 - INFO - 测试未授权访问...\n2025-08-16 23:59:18,241 - ERROR - 未授权访问测试失败: /api/admin/users - 期望401，实际: 404\n2025-08-16 23:59:18,243 - ERROR - 未授权访问测试失败: /api/admin/system - 期望401，实际: 404\n2025-08-16 23:59:18,246 - ERROR - 未授权访问测试失败: /api/admin/logs - 期望401，实际: 404\n2025-08-16 23:59:18,247 - ERROR - 未授权访问测试失败: /api/school/statistics - 期望401，实际: 404\n2025-08-16 23:59:18,248 - ERROR - 未授权访问测试失败: /api/school/reports - 期望401，实际: 404\n2025-08-16 23:59:18,248 - INFO - 3. 测试跨角色访问...\n2025-08-16 23:59:18,248 - INFO - 测试跨角色访问...\n2025-08-16 23:59:18,248 - INFO - 4. 测试资源隔离...\n2025-08-16 23:59:18,248 - INFO - 测试资源隔离...\n2025-08-16 23:59:18,249 - INFO - 权限控制测试套件执行完成\n2025-08-16 23:59:18,249 - INFO - 角色权限测试成功率: 0.0%\n2025-08-16 23:59:18,249 - INFO - 未授权访问阻止率: 0.0%\n2025-08-16 23:59:18,249 - INFO - 跨角色访问成功率: 0.0%\n2025-08-16 23:59:18,249 - INFO - 资源隔离成功率: 0.0%\n\n==================================================\n权限控制测试结果摘要\n==================================================\n测试账号总数: 0\n测试端点总数: 23\n角色权限测试成功率: 0.0%\n未授权访问阻止率: 0.0%\n跨角色访问成功率: 0.0%\n资源隔离成功率: 0.0%\n\n总体权限控制测试通过率: 0.0%\n\n详细测试结果已保存到: authorization_test_results.json\n测试日志已保存到: authorization_test.log\n",
      "error": "",
      "details": {
        "start_time": "2025-08-16T23:59:18.195768",
        "tests": {
          "role_permissions": {},
          "unauthorized_access": [
            {
              "endpoint": "/api/admin/users",
              "method": "GET",
              "token": null,
              "status_code": 404,
              "response_time": 0.0012378692626953125,
              "success": false,
              "description": "无token访问测试"
            },
            {
              "endpoint": "/api/admin/system",
              "method": "GET",
              "token": null,
              "status_code": 404,
              "response_time": 0.0015180110931396484,
              "success": false,
              "description": "无token访问测试"
            },
            {
              "endpoint": "/api/admin/logs",
              "method": "GET",
              "token": null,
              "status_code": 404,
              "response_time": 0.001981019973754883,
              "success": false,
              "description": "无token访问测试"
            },
            {
              "endpoint": "/api/school/statistics",
              "method": "GET",
              "token": null,
              "status_code": 404,
              "response_time": 0.0012388229370117188,
              "success": false,
              "description": "无token访问测试"
            },
            {
              "endpoint": "/api/school/reports",
              "method": "GET",
              "token": null,
              "status_code": 404,
              "response_time": 0.0010459423065185547,
              "success": false,
              "description": "无token访问测试"
            }
          ],
          "cross_role_access": [
            {
              "success": false,
              "error": "未找到有效会话",
              "test_type": "高权限访问低权限资源"
            },
            {
              "success": false,
              "error": "未找到有效会话",
              "test_type": "高权限访问低权限资源"
            },
            {
              "success": false,
              "error": "未找到有效会话",
              "test_type": "高权限访问低权限资源"
            },
            {
              "success": false,
              "error": "未找到有效会话",
              "test_type": "低权限访问高权限资源"
            },
            {
              "success": false,
              "error": "未找到有效会话",
              "test_type": "低权限访问高权限资源"
            },
            {
              "success": false,
              "error": "未找到有效会话",
              "test_type": "低权限访问高权限资源"
            }
          ],
          "resource_isolation": [
            {
              "success": false,
              "error": "未找到有效会话",
              "test_type": "教师访问自己的资源"
            },
            {
              "success": false,
              "error": "未找到有效会话",
              "test_type": "教师访问自己的资源"
            },
            {
              "success": false,
              "error": "未找到有效会话",
              "test_type": "教师访问自己的资源"
            },
            {
              "success": false,
              "error": "未找到有效会话",
              "test_type": "学生访问教师资源"
            },
            {
              "success": false,
              "error": "未找到有效会话",
              "test_type": "学生访问教师资源"
            },
            {
              "success": false,
              "error": "未找到有效会话",
              "test_type": "学生访问教师资源"
            }
          ]
        },
        "summary": {
          "total_accounts": 0,
          "total_endpoints": 23,
          "role_permission_success_rate": 0,
          "unauthorized_access_blocked_rate": 0.0,
          "cross_role_access_success_rate": 0.0,
          "resource_isolation_success_rate": 0.0
        },
        "end_time": "2025-08-16T23:59:18.248984"
      },
      "return_code": 0,
      "end_time": "2025-08-16T23:59:18.263863"
    },
    "test_core_functions.py": {
      "test_name": "核心功能测试",
      "script": "test_core_functions.py",
      "description": "测试备课、上课、成绩管理等核心功能",
      "priority": "high",
      "start_time": "2025-08-16T23:59:20.265266",
      "status": "passed",
      "duration": 0.12752079963684082,
      "output": "2025-08-16 23:59:20,360 - INFO - 成功加载 13 个测试账号\n2025-08-16 23:59:20,360 - INFO - 核心功能测试器初始化完成，基础URL: http://localhost:8000\n2025-08-16 23:59:20,360 - INFO - 开始执行完整核心功能测试套件...\n2025-08-16 23:59:20,360 - INFO - 找到 11 个活跃测试账号\n2025-08-16 23:59:20,365 - ERROR - 账号 admin_001 认证失败，状态码: 404\n2025-08-16 23:59:20,367 - ERROR - 账号 teacher_001 认证失败，状态码: 404\n2025-08-16 23:59:20,368 - ERROR - 账号 teacher_002 认证失败，状态码: 404\n2025-08-16 23:59:20,369 - ERROR - 账号 teacher_003 认证失败，状态码: 404\n2025-08-16 23:59:20,371 - ERROR - 账号 principal_001 认证失败，状态码: 404\n2025-08-16 23:59:20,372 - ERROR - 账号 director_001 认证失败，状态码: 404\n2025-08-16 23:59:20,374 - ERROR - 账号 student_001 认证失败，状态码: 404\n2025-08-16 23:59:20,375 - ERROR - 账号 student_002 认证失败，状态码: 404\n2025-08-16 23:59:20,376 - ERROR - 账号 parent_001 认证失败，状态码: 404\n2025-08-16 23:59:20,377 - ERROR - 账号 parent_002 认证失败，状态码: 404\n2025-08-16 23:59:20,379 - ERROR - 账号 guest_001 认证失败，状态码: 404\n2025-08-16 23:59:20,379 - INFO - 成功认证 0 个账号\n2025-08-16 23:59:20,379 - INFO - 核心功能测试套件执行完成\n2025-08-16 23:59:20,379 - INFO - 总体成功率: 0.0%\n\n==================================================\n核心功能测试结果摘要\n==================================================\n测试账号总数: 0\n测试用例总数: 0\n成功测试数: 0\n总体成功率: 0.0%\n\n各角色测试结果:\n\n详细测试结果已保存到: core_functions_test_results.json\n测试日志已保存到: core_functions_test.log\n",
      "error": "",
      "details": {
        "start_time": "2025-08-16T23:59:20.360958",
        "tests": {
          "role_functions": {}
        },
        "summary": {
          "total_accounts": 0,
          "total_tests": 0,
          "successful_tests": 0,
          "overall_success_rate": 0,
          "role_statistics": {}
        },
        "end_time": "2025-08-16T23:59:20.379312"
      },
      "return_code": 0,
      "end_time": "2025-08-16T23:59:20.392787"
    },
    "test_data_flow.py": {
      "test_name": "数据流测试",
      "script": "test_data_flow.py",
      "description": "测试客户端-服务端数据流",
      "priority": "high",
      "start_time": "2025-08-16T23:59:22.393360",
      "status": "failed",
      "duration": 0.14108705520629883,
      "output": "2025-08-16 23:59:22,499 - INFO - 成功加载 13 个测试账号\n2025-08-16 23:59:22,500 - INFO - 初始化测试数据: 50 学生, 20 考试, 1000 成绩记录\n2025-08-16 23:59:22,500 - INFO - 数据流测试器初始化完成，基础URL: http://localhost:8000\n2025-08-16 23:59:22,500 - INFO - 开始执行完整数据流测试套件...\n2025-08-16 23:59:22,500 - INFO - 找到 11 个活跃测试账号\n2025-08-16 23:59:22,504 - ERROR - 账号 admin_001 认证失败，状态码: 404\n2025-08-16 23:59:22,506 - ERROR - 账号 teacher_001 认证失败，状态码: 404\n2025-08-16 23:59:22,507 - ERROR - 账号 teacher_002 认证失败，状态码: 404\n2025-08-16 23:59:22,509 - ERROR - 账号 teacher_003 认证失败，状态码: 404\n2025-08-16 23:59:22,510 - ERROR - 账号 principal_001 认证失败，状态码: 404\n2025-08-16 23:59:22,512 - ERROR - 账号 director_001 认证失败，状态码: 404\n2025-08-16 23:59:22,513 - ERROR - 账号 student_001 认证失败，状态码: 404\n2025-08-16 23:59:22,514 - ERROR - 账号 student_002 认证失败，状态码: 404\n2025-08-16 23:59:22,515 - ERROR - 账号 parent_001 认证失败，状态码: 404\n2025-08-16 23:59:22,517 - ERROR - 账号 parent_002 认证失败，状态码: 404\n2025-08-16 23:59:22,518 - ERROR - 账号 guest_001 认证失败，状态码: 404\n2025-08-16 23:59:22,518 - INFO - 成功认证 0 个账号\n2025-08-16 23:59:22,518 - ERROR - 没有成功认证的账号，无法进行数据流测试\n\n==================================================\n数据流测试结果摘要\n==================================================\n2025-08-16 23:59:22,518 - ERROR - 数据流测试执行失败: 'total_accounts_tested'\n",
      "error": "Traceback (most recent call last):\n  File \"/Users/tangxiaolu/project/PythonProject/aiLearn/learn05/service/tests/test_data_flow.py\", line 702, in <module>\n    asyncio.run(main())\n    ~~~~~~~~~~~^^^^^^^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py\", line 194, in run\n    return runner.run(main)\n           ~~~~~~~~~~^^^^^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py\", line 118, in run\n    return self._loop.run_until_complete(task)\n           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py\", line 721, in run_until_complete\n    return future.result()\n           ~~~~~~~~~~~~~^^\n  File \"/Users/tangxiaolu/project/PythonProject/aiLearn/learn05/service/tests/test_data_flow.py\", line 678, in main\n    print(f\"测试账号总数: {summary['total_accounts_tested']}\")\n                           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyError: 'total_accounts_tested'\n",
      "details": {},
      "return_code": 1,
      "end_time": "2025-08-16T23:59:22.534445"
    },
    "test_security.py": {
      "test_name": "安全性测试",
      "script": "test_security.py",
      "description": "测试系统安全性",
      "priority": "high",
      "start_time": "2025-08-16T23:59:24.535817",
      "status": "passed",
      "duration": 5.209529161453247,
      "output": "2025-08-16 23:59:24,651 - INFO - 成功加载 13 个测试账号\n2025-08-16 23:59:24,652 - INFO - 安全性测试器初始化完成，基础URL: http://localhost:8000\n2025-08-16 23:59:24,652 - INFO - 开始执行完整安全性测试套件...\n2025-08-16 23:59:24,652 - INFO - 执行认证安全性测试...\n2025-08-16 23:59:24,652 - INFO - 开始测试认证安全性...\n2025-08-16 23:59:24,652 - INFO - 测试弱密码登录...\n2025-08-16 23:59:24,663 - INFO - 测试暴力破解防护...\n2025-08-16 23:59:29,707 - INFO - 测试SQL注入攻击...\n2025-08-16 23:59:29,716 - INFO - 测试会话固定攻击...\n2025-08-16 23:59:29,718 - INFO - 执行权限控制安全性测试...\n2025-08-16 23:59:29,718 - INFO - 开始测试权限控制安全性...\n2025-08-16 23:59:29,718 - INFO - 测试垂直权限提升...\n2025-08-16 23:59:29,718 - INFO - 测试水平权限提升...\n2025-08-16 23:59:29,718 - INFO - 测试未授权访问...\n2025-08-16 23:59:29,721 - INFO - 测试令牌篡改...\n2025-08-16 23:59:29,721 - INFO - 执行输入验证安全性测试...\n2025-08-16 23:59:29,721 - INFO - 开始测试输入验证安全性...\n2025-08-16 23:59:29,721 - ERROR - 没有找到活跃的教师账号\n2025-08-16 23:59:29,721 - INFO - 执行会话管理安全性测试...\n2025-08-16 23:59:29,721 - INFO - 开始测试会话管理安全性...\n2025-08-16 23:59:29,721 - INFO - 测试会话超时...\n2025-08-16 23:59:29,722 - INFO - 测试会话注销...\n2025-08-16 23:59:29,723 - INFO - 测试并发会话...\n2025-08-16 23:59:29,727 - INFO - 安全性测试套件执行完成\n2025-08-16 23:59:29,727 - INFO - 总体安全评分: 72.5分 (一般)\n2025-08-16 23:59:29,727 - INFO - 发现漏洞总数: 1 (高风险: 0, 中风险: 1, 低风险: 0)\n\n==================================================\n安全性测试结果摘要\n==================================================\n总体安全评分: 72.5分\n安全等级: 一般\n发现漏洞总数: 1\n\n漏洞分布:\n  高风险漏洞: 0个\n  中风险漏洞: 1个\n  低风险漏洞: 0个\n\n各项安全评分:\n  认证安全: 90.0分\n  权限控制: 100.0分\n  输入验证: 0.0分\n  会话管理: 100.0分\n\n安全建议:\n  1. 实施账号锁定和验证码机制防止暴力破解\n  2. 定期进行安全审计和渗透测试\n  3. 保持系统和依赖库的及时更新\n  4. 实施安全日志记录和监控\n  5. 对敏感数据进行加密存储和传输\n\n详细测试结果已保存到: security_test_results.json\n测试日志已保存到: security_test.log\n",
      "error": "",
      "details": {
        "start_time": "2025-08-16T23:59:24.652332",
        "tests": {
          "authentication_security": {
            "test_type": "认证安全性测试",
            "tests": {
              "weak_password_test": [
                {
                  "password": "123456",
                  "login_successful": false
                },
                {
                  "password": "password",
                  "login_successful": false
                },
                {
                  "password": "admin",
                  "login_successful": false
                },
                {
                  "password": "123123",
                  "login_successful": false
                },
                {
                  "password": "qwerty",
                  "login_successful": false
                },
                {
                  "password": "abc123",
                  "login_successful": false
                }
              ],
              "brute_force_protection": {
                "total_attempts": 10,
                "blocked_attempts": 0,
                "protection_exists": false,
                "attempts_details": [
                  {
                    "attempt": 1,
                    "status_code": 404,
                    "response_time": 0.0011529922485351562,
                    "blocked": false
                  },
                  {
                    "attempt": 2,
                    "status_code": 404,
                    "response_time": 0.005496978759765625,
                    "blocked": false
                  },
                  {
                    "attempt": 3,
                    "status_code": 404,
                    "response_time": 0.004224061965942383,
                    "blocked": false
                  },
                  {
                    "attempt": 4,
                    "status_code": 404,
                    "response_time": 0.0037279129028320312,
                    "blocked": false
                  },
                  {
                    "attempt": 5,
                    "status_code": 404,
                    "response_time": 0.0019321441650390625,
                    "blocked": false
                  },
                  {
                    "attempt": 6,
                    "status_code": 404,
                    "response_time": 0.0017371177673339844,
                    "blocked": false
                  },
                  {
                    "attempt": 7,
                    "status_code": 404,
                    "response_time": 0.0023550987243652344,
                    "blocked": false
                  },
                  {
                    "attempt": 8,
                    "status_code": 404,
                    "response_time": 0.0027370452880859375,
                    "blocked": false
                  },
                  {
                    "attempt": 9,
                    "status_code": 404,
                    "response_time": 0.0017368793487548828,
                    "blocked": false
                  },
                  {
                    "attempt": 10,
                    "status_code": 404,
                    "response_time": 0.005088090896606445,
                    "blocked": false
                  }
                ]
              },
              "sql_injection_test": [
                {
                  "payload": "' OR '1'='1",
                  "status_code": 404,
                  "sql_error_exposed": false,
                  "login_successful": false
                },
                {
                  "payload": "'; DROP TABLE users; --",
                  "status_code": 404,
                  "sql_error_exposed": false,
                  "login_successful": false
                },
                {
                  "payload": "' UNION SELECT * FROM users --",
                  "status_code": 404,
                  "sql_error_exposed": false,
                  "login_successful": false
                },
                {
                  "payload": "admin'--",
                  "status_code": 404,
                  "sql_error_exposed": false,
                  "login_successful": false
                },
                {
                  "payload": "' OR 1=1#",
                  "status_code": 404,
                  "sql_error_exposed": false,
                  "login_successful": false
                },
                {
                  "payload": "1' AND (SELECT COUNT(*) FROM users) > 0 --",
                  "status_code": 404,
                  "sql_error_exposed": false,
                  "login_successful": false
                }
              ],
              "session_fixation_test": []
            },
            "vulnerabilities": [
              "缺少暴力破解防护机制"
            ],
            "security_score": 90.0,
            "security_rating": "优秀"
          },
          "authorization_security": {
            "test_type": "权限控制安全性测试",
            "tests": {
              "vertical_privilege_escalation": [],
              "horizontal_privilege_escalation": [],
              "unauthorized_access": [
                {
                  "endpoint": "/api/user/profile",
                  "unauthorized_access_granted": false,
                  "status_code": 404
                },
                {
                  "endpoint": "/api/grades/list",
                  "unauthorized_access_granted": false,
                  "status_code": 404
                },
                {
                  "endpoint": "/api/lesson/list",
                  "unauthorized_access_granted": false,
                  "status_code": 404
                },
                {
                  "endpoint": "/api/admin/users",
                  "unauthorized_access_granted": false,
                  "status_code": 404
                },
                {
                  "endpoint": "/api/student/progress",
                  "unauthorized_access_granted": false,
                  "status_code": 404
                }
              ],
              "token_tampering": []
            },
            "vulnerabilities": [],
            "security_score": 100.0,
            "security_rating": "优秀"
          },
          "input_validation_security": {
            "test_type": "输入验证安全性测试",
            "tests": {},
            "vulnerabilities": [],
            "security_score": 0
          },
          "session_management_security": {
            "test_type": "会话管理安全性测试",
            "tests": {
              "session_timeout_test": [],
              "session_logout_test": [],
              "concurrent_session_test": [
                {
                  "total_sessions_created": 0,
                  "valid_concurrent_sessions": 0,
                  "multiple_sessions_allowed": false
                }
              ]
            },
            "vulnerabilities": [],
            "security_score": 100.0,
            "security_rating": "优秀"
          }
        },
        "summary": {
          "total_vulnerabilities": 1,
          "high_risk_vulnerabilities": 0,
          "medium_risk_vulnerabilities": 1,
          "low_risk_vulnerabilities": 0,
          "security_scores": {
            "authentication": 90.0,
            "authorization": 100.0,
            "input_validation": 0,
            "session_management": 100.0
          },
          "overall_security_score": 72.5,
          "security_level": "一般",
          "vulnerability_details": {
            "high_risk": [],
            "medium_risk": [
              "缺少暴力破解防护机制"
            ],
            "low_risk": []
          },
          "security_recommendations": [
            "实施账号锁定和验证码机制防止暴力破解",
            "定期进行安全审计和渗透测试",
            "保持系统和依赖库的及时更新",
            "实施安全日志记录和监控",
            "对敏感数据进行加密存储和传输"
          ]
        },
        "overall_vulnerabilities": [
          "缺少暴力破解防护机制"
        ],
        "end_time": "2025-08-16T23:59:29.727346"
      },
      "return_code": 0,
      "end_time": "2025-08-16T23:59:29.745346"
    },
    "test_concurrent_access.py": {
      "test_name": "并发访问测试",
      "script": "test_concurrent_access.py",
      "description": "测试多用户并发访问",
      "priority": "medium",
      "start_time": "2025-08-16T23:59:31.746477",
      "status": "passed",
      "duration": 37.24011707305908,
      "output": "2025-08-16 23:59:31,850 - INFO - 成功加载 13 个测试账号\n2025-08-16 23:59:31,850 - INFO - 并发访问测试器初始化完成，基础URL: http://localhost:8000\n2025-08-16 23:59:31,851 - INFO - 开始执行完整并发访问测试套件...\n2025-08-16 23:59:31,851 - INFO - 找到 11 个活跃测试账号\n2025-08-16 23:59:31,851 - INFO - 执行并发登录测试...\n2025-08-16 23:59:31,851 - INFO - 开始测试 10 个账号的并发登录...\n2025-08-16 23:59:31,858 - INFO - 执行并发API调用测试...\n2025-08-16 23:59:31,867 - INFO - 开始测试 8 个账号的并发API调用，持续 30 秒...\n2025-08-17 00:00:02,933 - INFO - 执行资源竞争测试...\n2025-08-17 00:00:02,934 - INFO - 开始测试 6 个账号的资源竞争...\n2025-08-17 00:00:02,934 - INFO - 执行系统负载能力测试...\n2025-08-17 00:00:02,934 - INFO - 开始测试系统负载能力，最大用户数: 11...\n2025-08-17 00:00:02,934 - INFO - 测试 3 个并发用户...\n2025-08-17 00:00:02,934 - INFO - 开始测试 3 个账号的并发登录...\n2025-08-17 00:00:04,940 - INFO - 测试 6 个并发用户...\n2025-08-17 00:00:04,940 - INFO - 开始测试 6 个账号的并发登录...\n2025-08-17 00:00:06,954 - INFO - 测试 9 个并发用户...\n2025-08-17 00:00:06,954 - INFO - 开始测试 9 个账号的并发登录...\n2025-08-17 00:00:08,962 - INFO - 并发访问测试套件执行完成\n2025-08-17 00:00:08,962 - INFO - 总体并发性能评分: 0.0分 (需要改进)\n2025-08-17 00:00:08,962 - INFO - 最大稳定用户数: 0\n\n==================================================\n并发访问测试结果摘要\n==================================================\n可用测试账号: 11\n总体性能评分: 0.0分\n性能等级: 需要改进\n\n各项测试结果:\n  并发登录: 0.0% (平均 0.00s)\n  并发API调用: 0.0% (6.2 req/s)\n  资源竞争: 0.0%\n  负载能力: 最大稳定用户数 0 (较差)\n\n详细测试结果已保存到: concurrent_access_test_results.json\n测试日志已保存到: concurrent_access_test.log\n",
      "error": "",
      "details": {
        "start_time": "2025-08-16T23:59:31.851028",
        "tests": {
          "concurrent_login": {
            "test_type": "并发登录测试",
            "total_accounts": 10,
            "successful_logins": 0,
            "failed_logins": 10,
            "success_rate": 0.0,
            "total_time": 0.00720524787902832,
            "avg_login_time": 0,
            "max_login_time": 0,
            "min_login_time": 0,
            "role_statistics": {
              "系统管理员": {
                "successful": 0,
                "failed": 1
              },
              "教师": {
                "successful": 0,
                "failed": 3
              },
              "校长": {
                "successful": 0,
                "failed": 1
              },
              "教务主任": {
                "successful": 0,
                "failed": 1
              },
              "学生": {
                "successful": 0,
                "failed": 2
              },
              "家长": {
                "successful": 0,
                "failed": 2
              }
            },
            "concurrent_level": 10
          },
          "concurrent_api_calls": {
            "test_type": "并发API调用测试",
            "test_duration": 31.065863847732544,
            "concurrent_users": 8,
            "total_requests": 194,
            "successful_requests": 0,
            "failed_requests": 194,
            "success_rate": 0.0,
            "requests_per_second": 6.244796569986892,
            "avg_response_time": 0,
            "max_response_time": 0,
            "min_response_time": 0,
            "endpoint_statistics": {
              "未知": {
                "total": 194,
                "successful": 0,
                "failed": 194
              }
            },
            "status_code_distribution": {}
          },
          "resource_competition": {
            "test_type": "资源竞争测试",
            "resource_id": "shared_resource_001",
            "concurrent_users": 6,
            "total_operations": 30,
            "successful_operations": 0,
            "failed_operations": 30,
            "overall_success_rate": 0.0,
            "read_operations": {
              "total": 18,
              "successful": 0,
              "success_rate": 0.0
            },
            "write_operations": {
              "total": 12,
              "successful": 0,
              "success_rate": 0.0
            },
            "test_duration": 0.00024080276489257812
          },
          "load_capacity": {
            "test_type": "系统负载能力测试",
            "max_tested_users": 11,
            "max_stable_users": 0,
            "performance_degradation_point": 3,
            "load_test_details": [
              {
                "concurrent_users": 3,
                "login_success_rate": 0.0,
                "api_success_rate": 0,
                "avg_response_time": 0,
                "requests_per_second": 0,
                "system_stable": false,
                "note": "登录成功率过低，跳过API测试"
              },
              {
                "concurrent_users": 6,
                "login_success_rate": 0.0,
                "api_success_rate": 0,
                "avg_response_time": 0,
                "requests_per_second": 0,
                "system_stable": false,
                "note": "登录成功率过低，跳过API测试"
              },
              {
                "concurrent_users": 9,
                "login_success_rate": 0.0,
                "api_success_rate": 0,
                "avg_response_time": 0,
                "requests_per_second": 0,
                "system_stable": false,
                "note": "登录成功率过低，跳过API测试"
              }
            ],
            "system_capacity_rating": "较差"
          }
        },
        "summary": {
          "total_accounts_available": 11,
          "concurrent_login": {
            "success_rate": 0.0,
            "avg_login_time": 0,
            "concurrent_level": 10
          },
          "concurrent_api_calls": {
            "success_rate": 0.0,
            "requests_per_second": 6.244796569986892,
            "avg_response_time": 0
          },
          "resource_competition": {
            "overall_success_rate": 0.0,
            "read_success_rate": 0.0,
            "write_success_rate": 0.0
          },
          "load_capacity": {
            "max_stable_users": 0,
            "system_capacity_rating": "较差"
          },
          "overall_concurrent_performance_score": 0.0,
          "performance_rating": "需要改进"
        },
        "end_time": "2025-08-17T00:00:08.961548"
      },
      "return_code": 0,
      "end_time": "2025-08-17T00:00:08.986596"
    },
    "test_performance.py": {
      "test_name": "性能测试",
      "script": "test_performance.py",
      "description": "测试系统性能表现",
      "priority": "medium",
      "start_time": "2025-08-17T00:00:10.988810",
      "status": "passed",
      "duration": 0.18930816650390625,
      "output": "2025-08-17 00:00:11,164 - INFO - 成功加载 13 个测试账号\n2025-08-17 00:00:11,165 - INFO - 性能测试器初始化完成，基础URL: http://localhost:8000\n2025-08-17 00:00:11,165 - INFO - 开始执行完整性能测试套件...\n2025-08-17 00:00:11,165 - ERROR - 没有找到活跃的教师账号\n\n==================================================\n性能测试结果摘要\n==================================================\n\n详细测试结果已保存到: performance_test_results.json\n测试日志已保存到: performance_test.log\n",
      "error": "",
      "details": {},
      "return_code": 0,
      "end_time": "2025-08-17T00:00:11.178111"
    }
  },
  "issues_summary": {
    "total_issues": 1,
    "unique_issues": [
      "缺少暴力破解防护机制"
    ],
    "issue_categories": {
      "其他问题": [
        "缺少暴力破解防护机制"
      ]
    }
  },
  "recommendations": {
    "test_recommendations": [
      "修复 1 个失败的测试用例",
      "优先修复 1 个高优先级测试问题",
      "定期执行集成测试以确保系统稳定性",
      "建立持续集成流水线自动化测试",
      "完善测试用例覆盖率",
      "建立测试数据管理机制"
    ],
    "technical_recommendations": [
      "保持系统和依赖库的及时更新",
      "对敏感数据进行加密存储和传输",
      "实施安全日志记录和监控",
      "定期进行安全审计和渗透测试",
      "实施账号锁定和验证码机制防止暴力破解"
    ],
    "next_steps": [
      "修复失败的测试用例",
      "优化性能问题",
      "增强错误处理机制"
    ]
  }
}