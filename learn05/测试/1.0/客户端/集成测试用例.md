# Flutter集成测试用例

## 1. 测试概述

### 1.1 测试目标
- 验证端到端业务流程完整性
- 确保模块间交互正确
- 验证数据流转正确性
- 确保用户体验连贯性

### 1.2 测试框架
- **测试工具**：Flutter Integration Test
- **测试类型**：End-to-End Test
- **运行环境**：真实设备/模拟器

## 2. 用户认证流程测试

### 2.1 完整登录流程测试

#### TC_I001: 用户登录完整流程
- **测试目标**：验证从启动到登录成功的完整流程
- **前置条件**：应用已安装，用户账号存在
- **测试步骤**：
  1. 启动应用
  2. 进入登录页面
  3. 输入用户名和密码
  4. 点击登录按钮
  5. 验证跳转到主页
- **预期结果**：
  - 登录成功
  - 跳转到主页
  - 显示用户信息

```dart
testWidgets('用户登录完整流程', (WidgetTester tester) async {
  app.main();
  await tester.pumpAndSettle();
  
  // 验证启动页面
  expect(find.text('智能教学助手'), findsOneWidget);
  
  // 进入登录页面
  await tester.tap(find.text('登录'));
  await tester.pumpAndSettle();
  
  // 输入登录信息
  await tester.enterText(find.byKey(const Key('username_field')), 'teacher001');
  await tester.enterText(find.byKey(const Key('password_field')), 'password123');
  
  // 点击登录
  await tester.tap(find.byKey(const Key('login_button')));
  await tester.pumpAndSettle();
  
  // 验证登录成功
  expect(find.text('欢迎回来'), findsOneWidget);
  expect(find.byType(BottomNavigationBar), findsOneWidget);
});
```

#### TC_I002: 登录失败处理流程
- **测试目标**：验证登录失败时的错误处理
- **前置条件**：应用已启动
- **测试步骤**：
  1. 进入登录页面
  2. 输入错误的用户名密码
  3. 点击登录
  4. 验证错误提示
- **预期结果**：显示错误提示，不跳转页面

### 2.2 用户注册流程测试

#### TC_I003: 新用户注册流程
- **测试目标**：验证新用户注册完整流程
- **前置条件**：应用已启动
- **测试步骤**：
  1. 点击注册链接
  2. 填写注册信息
  3. 提交注册
  4. 验证注册成功
- **预期结果**：注册成功，自动登录

## 3. 成绩管理流程测试

### 3.1 成绩录入流程测试

#### TC_I004: 单个学生成绩录入流程
- **测试目标**：验证单个学生成绩录入完整流程
- **前置条件**：用户已登录，有学生数据
- **测试步骤**：
  1. 导航到成绩管理页面
  2. 选择学生
  3. 选择科目
  4. 输入成绩
  5. 保存成绩
- **预期结果**：成绩成功保存并显示在列表中

```dart
testWidgets('单个学生成绩录入流程', (WidgetTester tester) async {
  // 假设已登录
  await tester.pumpWidget(MyApp());
  await tester.pumpAndSettle();
  
  // 导航到成绩管理
  await tester.tap(find.text('成绩管理'));
  await tester.pumpAndSettle();
  
  // 点击添加成绩
  await tester.tap(find.byKey(const Key('add_grade_button')));
  await tester.pumpAndSettle();
  
  // 选择学生
  await tester.tap(find.byKey(const Key('student_dropdown')));
  await tester.pumpAndSettle();
  await tester.tap(find.text('张三'));
  await tester.pumpAndSettle();
  
  // 选择科目
  await tester.tap(find.byKey(const Key('subject_dropdown')));
  await tester.pumpAndSettle();
  await tester.tap(find.text('数学'));
  await tester.pumpAndSettle();
  
  // 输入成绩
  await tester.enterText(find.byKey(const Key('score_field')), '95');
  
  // 保存成绩
  await tester.tap(find.byKey(const Key('save_button')));
  await tester.pumpAndSettle();
  
  // 验证成绩保存成功
  expect(find.text('成绩保存成功'), findsOneWidget);
  expect(find.text('张三'), findsOneWidget);
  expect(find.text('95'), findsOneWidget);
});
```

#### TC_I005: 批量成绩录入流程
- **测试目标**：验证批量成绩录入功能
- **前置条件**：用户已登录，有班级数据
- **测试步骤**：
  1. 进入批量录入页面
  2. 选择班级和科目
  3. 批量输入成绩
  4. 提交保存
- **预期结果**：所有成绩成功保存

### 3.2 成绩分析流程测试

#### TC_I006: 成绩统计分析流程
- **测试目标**：验证成绩统计分析功能
- **前置条件**：已有成绩数据
- **测试步骤**：
  1. 进入成绩分析页面
  2. 选择分析维度
  3. 生成统计图表
  4. 查看详细数据
- **预期结果**：正确显示统计图表和数据

```dart
testWidgets('成绩统计分析流程', (WidgetTester tester) async {
  await tester.pumpWidget(MyApp());
  await tester.pumpAndSettle();
  
  // 导航到成绩分析
  await tester.tap(find.text('成绩分析'));
  await tester.pumpAndSettle();
  
  // 选择分析类型
  await tester.tap(find.byKey(const Key('analysis_type_dropdown')));
  await tester.pumpAndSettle();
  await tester.tap(find.text('班级对比'));
  await tester.pumpAndSettle();
  
  // 生成图表
  await tester.tap(find.byKey(const Key('generate_chart_button')));
  await tester.pumpAndSettle();
  
  // 验证图表显示
  expect(find.byType(PieChart), findsOneWidget);
  expect(find.text('平均分'), findsOneWidget);
});
```

## 4. 学生管理流程测试

### 4.1 学生信息管理流程

#### TC_I007: 添加学生完整流程
- **测试目标**：验证添加学生的完整流程
- **前置条件**：用户已登录
- **测试步骤**：
  1. 进入学生管理页面
  2. 点击添加学生
  3. 填写学生信息
  4. 保存学生信息
  5. 验证学生添加成功
- **预期结果**：学生成功添加到列表中

#### TC_I008: 编辑学生信息流程
- **测试目标**：验证编辑学生信息功能
- **前置条件**：已有学生数据
- **测试步骤**：
  1. 选择要编辑的学生
  2. 修改学生信息
  3. 保存修改
  4. 验证修改成功
- **预期结果**：学生信息成功更新

### 4.2 班级管理流程测试

#### TC_I009: 创建班级流程
- **测试目标**：验证创建班级功能
- **前置条件**：用户已登录
- **测试步骤**：
  1. 进入班级管理页面
  2. 点击创建班级
  3. 填写班级信息
  4. 添加学生到班级
  5. 保存班级
- **预期结果**：班级创建成功，学生正确分配

## 5. 备课功能流程测试

### 5.1 课程创建流程测试

#### TC_I010: 创建新课程流程
- **测试目标**：验证创建新课程的完整流程
- **前置条件**：用户已登录
- **测试步骤**：
  1. 进入备课页面
  2. 点击新建课程
  3. 填写课程基本信息
  4. 添加教学内容
  5. 设置课程目标
  6. 保存课程
- **预期结果**：课程创建成功，内容正确保存

```dart
testWidgets('创建新课程流程', (WidgetTester tester) async {
  await tester.pumpWidget(MyApp());
  await tester.pumpAndSettle();
  
  // 导航到备课页面
  await tester.tap(find.text('备课'));
  await tester.pumpAndSettle();
  
  // 点击新建课程
  await tester.tap(find.byKey(const Key('new_lesson_button')));
  await tester.pumpAndSettle();
  
  // 填写课程信息
  await tester.enterText(find.byKey(const Key('lesson_title')), '数学第一课');
  await tester.enterText(find.byKey(const Key('lesson_content')), '今天学习加法运算');
  
  // 保存课程
  await tester.tap(find.byKey(const Key('save_lesson_button')));
  await tester.pumpAndSettle();
  
  // 验证保存成功
  expect(find.text('课程保存成功'), findsOneWidget);
  expect(find.text('数学第一课'), findsOneWidget);
});
```

### 5.2 教学资源管理流程

#### TC_I011: 上传教学资源流程
- **测试目标**：验证上传教学资源功能
- **前置条件**：在课程编辑页面
- **测试步骤**：
  1. 点击添加资源
  2. 选择资源类型
  3. 上传文件
  4. 设置资源属性
  5. 保存资源
- **预期结果**：资源上传成功，正确关联到课程

## 6. 上课功能流程测试

### 6.1 课堂管理流程测试

#### TC_I012: 开始上课流程
- **测试目标**：验证开始上课的完整流程
- **前置条件**：已有课程计划
- **测试步骤**：
  1. 选择要上的课程
  2. 点击开始上课
  3. 进入课堂界面
  4. 使用课堂工具
  5. 结束课程
- **预期结果**：课堂功能正常，数据正确记录

#### TC_I013: 课堂互动流程
- **测试目标**：验证课堂互动功能
- **前置条件**：课堂已开始
- **测试步骤**：
  1. 发起课堂提问
  2. 记录学生回答
  3. 进行课堂测验
  4. 查看参与度统计
- **预期结果**：互动功能正常，统计数据准确

## 7. 数据同步流程测试

### 7.1 离线数据同步测试

#### TC_I014: 离线数据同步流程
- **测试目标**：验证离线数据同步功能
- **前置条件**：有离线操作数据
- **测试步骤**：
  1. 断开网络连接
  2. 进行数据操作
  3. 恢复网络连接
  4. 触发数据同步
  5. 验证同步结果
- **预期结果**：离线数据成功同步到服务器

### 7.2 数据备份恢复测试

#### TC_I015: 数据备份恢复流程
- **测试目标**：验证数据备份和恢复功能
- **前置条件**：有完整的用户数据
- **测试步骤**：
  1. 执行数据备份
  2. 清除本地数据
  3. 执行数据恢复
  4. 验证数据完整性
- **预期结果**：数据完整恢复，功能正常

## 8. 跨页面导航测试

### 8.1 复杂导航流程测试

#### TC_I016: 多级页面导航流程
- **测试目标**：验证复杂的页面导航流程
- **前置条件**：用户已登录
- **测试步骤**：
  1. 从主页导航到成绩管理
  2. 进入成绩详情页面
  3. 跳转到学生详情
  4. 返回到成绩管理
  5. 切换到其他模块
- **预期结果**：导航流畅，页面状态正确保持

```dart
testWidgets('多级页面导航流程', (WidgetTester tester) async {
  await tester.pumpWidget(MyApp());
  await tester.pumpAndSettle();
  
  // 导航到成绩管理
  await tester.tap(find.text('成绩管理'));
  await tester.pumpAndSettle();
  
  // 点击成绩详情
  await tester.tap(find.byKey(const Key('grade_item_0')));
  await tester.pumpAndSettle();
  
  // 验证详情页面
  expect(find.text('成绩详情'), findsOneWidget);
  
  // 点击学生信息
  await tester.tap(find.byKey(const Key('student_info_button')));
  await tester.pumpAndSettle();
  
  // 验证学生详情页面
  expect(find.text('学生详情'), findsOneWidget);
  
  // 返回成绩管理
  await tester.tap(find.byIcon(Icons.arrow_back));
  await tester.pumpAndSettle();
  await tester.tap(find.byIcon(Icons.arrow_back));
  await tester.pumpAndSettle();
  
  // 验证回到成绩管理页面
  expect(find.text('成绩管理'), findsOneWidget);
});
```

## 9. 错误恢复流程测试

### 9.1 网络异常处理测试

#### TC_I017: 网络中断恢复流程
- **测试目标**：验证网络中断时的应用行为
- **前置条件**：应用正常运行
- **测试步骤**：
  1. 模拟网络中断
  2. 尝试进行网络操作
  3. 验证错误提示
  4. 恢复网络连接
  5. 重试操作
- **预期结果**：应用正确处理网络异常，恢复后功能正常

### 9.2 应用崩溃恢复测试

#### TC_I018: 应用异常恢复流程
- **测试目标**：验证应用异常后的恢复能力
- **前置条件**：应用有未保存数据
- **测试步骤**：
  1. 模拟应用异常
  2. 重启应用
  3. 验证数据恢复
  4. 验证功能正常
- **预期结果**：应用能够恢复到异常前状态

## 10. 性能相关集成测试

### 10.1 大数据量处理测试

#### TC_I019: 大量数据加载流程
- **测试目标**：验证大量数据的加载和处理
- **前置条件**：有大量测试数据
- **测试步骤**：
  1. 加载包含大量数据的页面
  2. 测试滚动性能
  3. 测试搜索功能
  4. 测试数据筛选
- **预期结果**：应用在大数据量下仍能流畅运行

## 11. 测试执行指南

### 11.1 测试环境配置
```bash
# 创建集成测试目录
mkdir -p integration_test

# 添加集成测试依赖
flutter pub add integration_test --dev

# 运行集成测试
flutter test integration_test/

# 在真实设备上运行
flutter drive --driver=test_driver/integration_test.dart --target=integration_test/app_test.dart
```

### 11.2 测试数据准备
- **Mock数据**：准备各种场景的测试数据
- **用户账号**：创建测试用户账号
- **网络模拟**：配置网络状态模拟
- **设备配置**：准备不同类型的测试设备

### 11.3 测试报告生成
```bash
# 生成测试报告
flutter test --reporter=json > test_results.json

# 生成HTML报告
flutter test --coverage
genhtml coverage/lcov.info -o coverage/html
```

---

**文档版本**：1.0  
**创建日期**：2024年1月  
**测试类型**：集成测试  
**覆盖范围**：端到端业务流程